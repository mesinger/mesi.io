<!DOCTYPE HTML>

<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/shared.html :: head"></head>

<body>
<header th:replace="fragments/shared.html :: header"></header>

<main class="bg-surface">
    <div class="main">

        <div class="pt-3"></div>

        <div class="container-fluid pt-2 pb-2">
            <div class="shadow-sm rounded dashboard-item">
                <h1 class="display-4">Clipboard</h1>
                <form action="#" th:action="@{/clipboard}" th:object="${newEntryContent}" method="post">
                    <div class="form-group">
                        <input type="text" class="form-control" id="add-clipboard-input"
                               placeholder="Add a new clipboard entry ..." th:field="*{raw}">
                    </div>
                    <button type="submit" class="btn w-100 button-primary">Add</button>
                </form>
            </div>
        </div>

        <div class="container-fluid pt-2 pb-2">
            <div class="shadow-sm rounded dashboard-item">
                <h3>Previous entries</h3>

                <table class="table table-striped">
                    <thead>
                    <tr>
                        <th scope="col">#</th>
                        <th scope="col">Timestamp</th>
                        <th scope="col"></th>
                        <th scope="col">Content</th>
                        <th scope="col"></th>
                        <th scope="col"></th>
                    </tr>
                    </thead>
                    <tbody>

                    <th:block th:each="entry,it : ${clipboardEntries}">
                        <tr>
                            <th scope="row"><span th:text="${it.index + 1}"></span></th>
                            <td colspan="2"><span th:text="${#temporals.format(entry.timeStamp, 'dd.MM.yyyy')}"></span></td>
                            <td colspan="2"><strong th:text="${entry.content}"></strong></td>
                            <td><a href="#" th:onclick="'javascript:saveToClipboard(\'clipboard-text-' + ${it.index} + '\')'">Copy</a></td>
                        </tr>
                    </th:block>

                    </tbody>
                </table>
            </div>
        </div>
    </div>
</main>

<div class="">
    <th:block th:each="entry,it : ${clipboardEntries}">
        <input type="text" readonly class="form-control-plaintext copyable-text text-white" th:id="'clipboard-text-' + ${it.index}" th:value="${entry.content}">
    </th:block>
</div>

<footer th:replace="fragments/shared.html :: footer"></footer>
</body>

<script>
    function saveToClipboard(id) {
        var content = document.getElementById(id);
        content.select();
        document.execCommand('copy');
        content.blur();
    }
</script>
</html>